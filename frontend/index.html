<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>Форма договора</title>
</head>
<body>
    <h2>Заполните данные</h2>
    <form id="contractForm">
        <input name="first_name" placeholder="Имя"><br>
        <input name="last_name" placeholder="Фамилия"><br>
        <input name="middle_name" placeholder="Отчество"><br>
        <input name="birth_date" placeholder="Дата рождения"><br>
        <input name="phone" placeholder="Телефон"><br>
        <select name="gender">
            <option value="Мужской">Мужской</option>
            <option value="Женский">Женский</option>
        </select><br>
        <button type="submit">Скачать договор</button>
    </form>

    <script>
        const form = document.getElementById('contractForm');
        form.onsubmit = async (e) => {
            e.preventDefault();

            const formData = new FormData(form);
            const json = {};
            formData.forEach((v, k) => json[k] = v);

            const res = await fetch('/submit', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(json)
            });

            const blob = await res.blob();
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = "Договор.docx";
            document.body.appendChild(a);
            a.click();
            a.remove();
        }
    </script>
</body>
</html>
